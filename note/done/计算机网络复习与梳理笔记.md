# 前言 #

因为是梳理所以对内容重新组织并选取认为对自己可能有用的。突然发现可以不发布......


# 结构 #

物理层，数据链路层，网络层，运输层，应用层，七层的暂时无视

- 物理层：网卡，网线，集线器，中继器，调制解调器

- 数据链路层：网桥，交换机

- 网络层：路由器

## 物理层 ##

顾名思义，但好像对我没什么用...

## 数据链路层 ##

停等协议、滑动窗口协议、ack、废弃的hdlc

ppp协议(point-to-point protocol)：

- 面向字节而非比特
- ip数据部分不超过1500字节

## 网络互连 ##

### 局域网 ###

以太网是目前最常用的局域网通信协议标准，使用CSMA/CD(carrier sense multiple access with conflict detection) (ca conflict avoidence)

MAC：48bit，固化在网卡的ROM中

单播广播多播 

局域网扩展（合并）

- 物理层：转发器（信号衰减所以用它加强下）、集线器（会被拉低速度，比较渣）
- 数据链路层：网桥（种类比较复杂，主要是检测报文是否发往目的局域网），交换机是一种网桥

vpn是在广域网上建立逻辑上的专用连接，vlan是对局域网进行划分

### 广域网 ###

数据报（udp）虚电路（tcp）另：这俩协议是传输层的

其他东西太多了但是目前看起来没啥用

### 网络互连 ###

中间设备

- 物理层：转发器
- 数据链路层：网桥
- 网络层：路由器
- 网络层以上：网关

ping 255可以ping网段但是很多路由和系统都会无视这个

ICMP（internet control message protocol）ping就用的这个

AS（autonomous system）自主选择内部路由选择协议，so路由选择协议分为内部的IGP(interior gateway protocol)和外部的EGP(external gateway protocol)

IGP中常用rip和ospf，都是基于距离选择

百度知道：
 > RIP协议是一种传统的路由协议，适合比较小型的网络，但是当前Internet网络的迅速发展和急剧膨胀使RIP协议无法适应今天的网络。OSPF协议则是在Internet网络急剧膨胀的时候制定出来的，它克服了RIP协议的许多缺陷。RIP是距离矢量路由协议；OSPF是链路状态路由协议。
> 
> RIP&OSPF管理距离分别是：120和110
> 
>     1．RIP协议一条路由有15跳（网关或路由器）的限制，如果一个RIP网络路由跨越超过15跳（路由器），则它认为网络不可到达，而OSPF对跨越路由器的个数没有限制。
> 
>     2．OSPF协议支持可变长度子网掩码（VLSM），RIP则不支持，这使得RIP协议对当前IP地址的缺乏和可变长度子网掩码的灵活性缺少支持。
> 
>     3．RIP协议不是针对网络的实际情况而是定期地广播路由表，这对网络的带宽资源是个极大的浪费，特别对大型的广域网。OSPF协议的路由广播更新只发生在路由状态变化的时候，采用IP多路广播来发送链路状态更新信息，这样对带宽是个节约。
> 
>     4．RIP网络是一个平面网络，对网络没有分层。OSPF在网络中建立起层次概念，在自治域中可以划分网络域，使路由的广播限制在一定的范围内，避免链路中继资源的浪费。
> 
>     5．OSPF在路由广播时采用了授权机制，保证了网络安全。
>     
> OSPF的缺点
> 1、配置相对复杂.由于网络区域划分和网络属性的复杂性,需要网络分析员有较高的网络知识水平才能配置和管理OSPF网络.
> 
> 2、路由负载均衡能力较弱.OSPF虽然能根据接口的速率、连接可靠性等信息,自动生成接口路由优先级,但通往同一目的的不同优先级路由,OSPF只选择优先级较高的转发,不同优先级的路由,不能实现负载分担.只有相同优先级的,才能达到负载均衡的目的,不象EIGRP那样可以根据优先级不同,自动匹配流量.


EGP主要用bgp，貌似对我有点遥远不看了- -

## 运输层（传输层？） ##

TCP(transmission control protocol)
UDP(user datagram protocol)

![](http://i.imgur.com/KEhCtAH.jpg)

> l 源端口（Source Port）：16位的源端口字段包含初始化通信的端口号。源端口和IP地址的作用是标识报文的返回地址。
> 
> l 目的端口(Destination Port):16位的目的端口字段定义传输的目的。这个端口指明接收方计算机上的应用程序接口。
> 
> l 序列号（Sequence Number）:该字段用来标识TCP源端设备向目的端设备发送的字节流，它表示在这个报文段中的第几个数据字节。序列号是一个32位的数。
> 
> l 确认号（Acknowledge Number）：TCP使用32位的确认号字段标识期望收到的下一个段的第一个字节，并声明此前的所有数据已经正确无误地收到，因此，确认号应该是上次已成功收到的数据字节序列号加1。收到确认号的源计算机会知道特定的段已经被收到。确认号的字段只在ACK标志被设置时才有效。
> 
> l 数据偏移（Data Offset）:这个4位字段包括TCP头大小。由于首部可能含有选项内容，因此TCP首部的长度是不确定的。首部长度的单位是32比特或4个八位组。首部长度实际上也指示了数据区在报文段中的起始偏移值。
> 
> l 保留（Reserved）:6位置0的字段。为将来定义新的用途保留。、
> 
> l 控制位(Control Bits):共6位，每一位标志可以打开一个控制功能。
> 
> URG(Urgent Pointer Field Significant,紧急指针字段标志):表示TCP包的紧急指针字段有效，用来保证TCP连接不被中断，并且督促中间齐备尽快处理这些数据。
> 
> ACK（Acknowledgement field significant,确认字段标志）: 取1时表示应答字段有效，也即TCP应答号将包含在TCP段中，为0则反之。
> 
> PSH(Push Function,推功能)：这个标志表示Push操作。所谓Push操作就是指在数据包到达接收端以后，立即送给应用程序，而不是在缓冲区中排队。
> 
> RST（Reset the connection,重置连接）：这个标志表示感谢连接复位请求，用来复位那些产生错误的连接，也被用来拒绝错误和非法的数据包。
> 
> SYN（Synchronize sequence numbers,同步序列号）:表示同步序号，用来建立连接。
> 
> FIN（No more data from sender）:表示发送端已经发送到数据末尾，数据传送完成，发送FIN标志位的TCP段，连接将被断开。
> 
> l 窗口（Window）:目的主机使用16位的窗口字段告诉源主机它期望每次收到的数据通的字节数。
> 
> l 校验和（Checksum）:TCP头包括16位的校验和字段用于错误检查。源主机基于部分IP头信息，TCP头和数据内容计算一个校验和，目的主机也要进行相同的计算，如果收到的内容没有错误过，两个计算应该完全一样，从而证明数据的有效性。
> 
> l 紧急指针（Urgent Pointer）:紧急指针字段是一个可选的16位指针，指向段内的最后一个字节位置，这个字段只在URG标志被设置时才有效。
> 
> l 选项（Option）:至少1字节的可变长字段，标识哪个选项（如果有的话）有效。如果没有选项，这个字节等于0,说明选项的结束。这个字节等于1表示无需再有操作；等于2表示下四个字节包括源机器的最大长度（Maximum Segment Size,MSS）.
> 
> l 填充（Padding）:这个字段中加入额外的零，以保证TCP头是32的整数倍。


![](http://i.imgur.com/aoNCrtp.jpg)

> 2字节源端口字段：源端口是一个大于1023的16位数字，由基于UDP应用程序的用户进程随机选择。
> 
> 2字节的端口字段
> 
> 2字节长度字段：指明了包括首部在内的UDP报文段长度。UDP长字段的值是UDP报文头的长度(8字节)与UDP所携带数据长度的总和。
> 
> 2字节校验和字段：是指整个UDP报文头和UDP所带的数据的校验和（也包括伪报文头）。伪报文头不包括在真正的UDP报文头中，但是它可以保证UDP数据被正确的主机收到了。因在校验和中加入了伪头标，故ICMP除能防止单纯数据差错之外，对IP分组也具有保护作用。


## 应用层 ##

DNS，域名ip映射，被做成数据库，域名查询用递归查询，
- 本地域名服务器：由isp设置，这就是为什么以前学校的各种视频为啥打不开？
- 根域名服务器：根节点
- 域名授权服务器：注册审核域名于ip的映射

顶级域名3种


- 国家域名：.cn.us.uk
- 国际顶级域名：.int这个不常见，但是联合国\*\*，国际\*\*，欧洲\*\*之类的网站在这个域名下面
- 通用顶级域名：.com商业，.net网络服务，.org非盈利性组织，值得一说的是.edu.gov和.mil分别教育政府军事，但是顶级域名是美国专用的，中国的是在cn下同名的二级域名，比如seu.edu.cn,www.nanjing.gov.cn

FTP(file transfer protocol)不解释了

TFTP(trival file transfer protocol)，简单文件传送协议，trival(不重要的)，只传输不交互，所以可以用于udp，占用内存小，发送方式类似停等(总感觉这样会很慢)

URL：
> <URL的访问方式\>://<主机>:<端口>/<路径>(虽然是废话但还是写下，一般使用http和ftp)

后面记得学前端，html先略过

DHCP过程：A需要获取ip，B是DHCP服务器，广播范围太大会用个DHCP代理，收到后单播到实际的DHCP服务器

1. A发送(255.255.255.255广播，源ip为空)
2. 只有B应答，现在数据库中查找配置信息，再从ip池中分一个给它

## 网络安全 ##

- 截获
- 中断
- 篡改
- 伪造

DES(Data Encryption Standard)：单秘钥，3DES，双秘钥，加密过程(加k1解k2加k1)解密反之,所有秘钥双方共有，需要秘钥分配

RSA(竟然是人名......)：公钥私钥分开，顾名思义，

数字签名，顾名思义可以想想

3/28/2017 11:14:13 AM 
